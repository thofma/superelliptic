using Test

# Some hyperelliptic curves
println("1")
F, w = FiniteField(1901, 1, "w")
Fx, x = F['x']
Fx, x = F['x']
h = x^11 + 151*x^10 + 1690*x^9 + 115*x^8 + 1387*x^7 + 1659*x^6 + 747*x^5 + 1145*x^4 + 190*x^3 + 959*x^2 + 1806*x + 585
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (24826219126109501*t^10 - 326488941690025*t^9 + 34287349983691*t^8 - 404864967433*t^7 + 24796406375*t^6 - 244496861*t^5 + 13043875*t^4 - 112033*t^3 +
4991*t^2 - 25*t + 1)//(1901*t^2 - 1902*t + 1)

F, w = FiniteField(653, 3, "w")
Fx, x = F['x']
h = x^3 + (279*w^2 + 539*w + 155)*x^2 + (235*w^2 + 344*w + 331)*x + 196*w^2 + 283*w + 221
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (278445077*t^2 + 186695*t + 1)//(278445077*t^2 - 278445078*t + 1)

F, w = FiniteField(2837, 1, "w")
Fx, x = F['x']
h = x^3 + 1210*x^2 + 142*x + 2650
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (2837*t^2 + 59*t + 1)//(2837*t^2 - 2838*t + 1)

F, w = FiniteField(2357, 2, "w")
Fx, x = F['x']
h = x^5 + (1290*w + 883)*x^4 + (200*w + 885)*x^3 + (387*w + 1708)*x^2 + (1601*w  + 1894)*x + 2159*w + 2276
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (30863013591601*t^4 - 18216317271*t^3 + 12418681*t^2 - 3279*t + 1)//(5555449*t^2 - 5555450*t + 1)

F, w = FiniteField(3919, 3, "w")
Fx, x = F['x']
h = x^7 + (486*w^2 + 1357*w + 1677)*x^6 + (3802*w^2 + 1459*w + 3558)*x^5 + (3677*w^2 + 2357*w + 2762)*x^4 + (3399*w^2 + 3849*w + 1154)*x^3 + (1089*w^2 + 2906*w + 2283)*x^2 + (3553*w^2 + 291*w + 1592)*x + 2571*w^2 + 2412*w + 2550
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (218060684643419379643961833276879*t^6 + 1173741492007215080147323517824405568031275*t^5 - 7837452524084717911406108280443*t^4 + 624215643167698582353*t^3 - 130211437265477178677*t^2 + 323981995763518179275*t + 1)//(60190200559*t^2 - 60190200560*t + 1)

F, w = FiniteField(227, 3, "w")
Fx, x = F['x']
h = x^7 + (59*w^2 + 220*w + 53)*x^6 + (174*w^2 + 153*w + 70)*x^5 + (191*w^2 + 181*w + 162)*x^4 + (179*w^2 + 39*w + 77)*x^3 + (188*w^2 + 213*w + 23)*x^2 + (124*w^2 + 119*w + 197)*x + 93*w^2 + 198*w + 65
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (1600415374247183470787*t^6 - 8124376349851240148030404016*t^5 + 419895827762799370780*t^4 + 58418797549137*t^3 + 35897482112660*t^2 - 59379274916144*t + 1)//(11697083*t^2 - 11697084*t + 1)

F, w = FiniteField(1831, 3, "w")
Fx, x = F['x']
h = x^7 + (621*w^2 + 1659*w + 363)*x^6 + (1783*w^2 + 567*w + 538)*x^5 + (1260*w^2 + 1084*w + 784)*x^4 + (321*w^2 + 8*w + 1005)*x^3 + (1235*w^2 + 1440*w  + 1310)*x^2 + (380*w^2 + 1110*w + 717)*x + 1177*w^2 + 1023*w + 1581
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (231310367559550740879663744871*t^6 - 367262179712092692863716525951933455375*t^5 - 90485816096543801813465459846*t^4  - 294351755869642889*t^3 - 14740610637333601706*t^2 - 9746442873791025375*t + 1)//(6138539191*t^2 - 6138539192*t + 1)

F, w = FiniteField(2879, 2, "w")
Fx, x = F['x']
h = x^5 + (1765*w + 786)*x^4 + (1001*w + 776)*x^3 + (591*w + 1834)*x^2 + (794*w  + 1228)*x + 1725*w + 1177
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (68701569626881*t^4 + 16254025001*t^3 + 3431269*t^2 + 1961*t + 1)//(8288641*t^2 - 8288642*t + 1)

F, w = FiniteField(2843, 2, "w")
Fx, x = F['x']
h = x^5 + (235*w + 1585)*x^4 + (58*w + 2614)*x^3 + (708*w + 2172)*x^2 + (577*w +
46)*x + 1130*w + 1221
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (65329214857201*t^4 - 14185048995*t^3 + 3572341*t^2 - 1755*t + 1)//(8082649*t^2 - 8082650*t + 1)

F, w = FiniteField(2357, 3, "w")
Fx, x = F['x']
h = x^5 + (1356*w^2 + 611*w + 322)*x^4 + (1542*w^2 + 1611*w + 501)*x^3 + (1226*w^2 + 1816*w + 1990)*x^2 + (1834*w^2 + 533*w + 1387)*x + 2048*w^2 + 1642*w + 801
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (171457897994446183849*t^4 - 4374497206704971079627*t^3 - 6736010073742*t^2  - 334079168439*t + 1)//(13094193293*t^2 - 13094193294*t + 1)

F, w = FiniteField(1933, 1, "w")
Fx, x = F['x']
h = x^7 + 630*x^6 + 1397*x^5 + 566*x^4 + 459*x^3 + 1030*x^2 + 1552*x + 753
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (7222633237*t^6 + 26155423*t^5 + 1536735*t^4 + 120023*t^3 + 795*t^2 + 7*t + 1)//(1933*t^2 - 1934*t + 1)

F, w = FiniteField(2579, 2, "w")
Fx, x = F['x']
h = x^7 + (1305*w + 352)*x^6 + (936*w + 2127)*x^5 + (169*w + 570)*x^4 + (2119*w  + 405)*x^3 + (369*w + 1848)*x^2 + (363*w + 1699)*x + 2387*w + 1145
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (294244296094027190521*t^6 - 34639142355783423*t^5 + 16703707156447*t^4 - 18880756937*t^3 + 2511367*t^2 - 783*t + 1)//(6651241*t^2 - 6651242*t + 1)

println("2")
F, w = FiniteField(4091, 1, "w")
Fx, x = F['x']
h = x^9 + 1971*x^8 + 2037*x^7 + 1326*x^6 + 1886*x^5 + 1366*x^4 + 1464*x^3 + 1567*x^2 + 3088*x + 3202
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (280103101710961*t^8 + 342340627855*t^7 + 38108511837*t^6 - 1304828541*t^5 -
4463825*t^4 - 318951*t^3 + 2277*t^2 + 5*t + 1)//(4091*t^2 - 4092*t + 1)

F, w = FiniteField(211, 2, "w")
Fx, x = F['x']
h = x^5 + w^38215*x^4 + w^39421*x^3 + w^38991*x^2 + w^2284*x + w^3489
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (1982119441*t^4 - 17852921*t^3 + 81933*t^2 - 401*t + 1)//(44521*t^2 - 44522*t + 1)

F, w = FiniteField(383, 1, "w")
Fx, x = F['x']
h = x^9 + 342*x^8 + 354*x^7 + 43*x^6 + 66*x^5 + 202*x^4 + 269*x^3 + 109*x^2 + 262*x + 228
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (21517662721*t^8 + 1404547175*t^7 + 70557409*t^6 + 569521*t^5 + 22571*t^4 + 1487*t^3 + 481*t^2 + 25*t + 1)//(383*t^2 - 384*t + 1)

F, w = FiniteField(1913, 3, "w")
Fx, x = F['x']
h = x^7 + (773*w^2 + 1578*w + 644)*x^6 + (1126*w^2 + 1398*w + 881)*x^5 + (776*w^2 + 388*w + 1183)*x^4 + (1310*w^2 + 1606*w + 1774)*x^3 + (19*w^2 + 1137*w + 115)*x^2 + (1317*w^2 + 1226*w + 820)*x + 1389*w^2 + 1111*w + 1063
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (343111070045721276530873148473*t^6 + 156866337055473124528442240120332874082*t^5 + 43362482032358860068934101142*t^4  + 4287777394276838132*t^3 + 6193971786465157286*t^2 + 3200662896971000898*t + 1)//(7000755497*t^2 - 7000755498*t + 1)

F, w = FiniteField(241, 2, "w")
Fx, x = F['x']
h = x^7 + w^13874*x^6 + w^45802*x^5 + w^31426*x^4 + w^13264*x^3 + w^41308*x^2 + w^22796*x + w^48021
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (195930594145441*t^6 + 1420202478181*t^5 + 6978954879*t^4 + 28414773*t^3 + 120159*t^2 + 421*t + 1)//(58081*t^2 - 58082*t + 1)

F, w = FiniteField(1453, 2, "w")
Fx, x = F['x']
h = x^5 + (113*w + 307)*x^4 + (582*w + 1104)*x^3 + (1027*w + 955)*x^2 + (375*w +
580)*x + 185*w + 1143
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (4457203441681*t^4 - 1032381201*t^3 - 1097741*t^2 - 489*t + 1)//(2111209*t^2  - 2111210*t + 1)

F, w = FiniteField(1181, 3, "w")
Fx, x = F['x']
h = x^9 + (1082*w^2 + 1045*w + 926)*x^8 + (1132*w^2 + 392*w + 211)*x^7 + (127*w^2 + 344*w + 1097)*x^6 + (210*w^2 + 911*w + 868)*x^5 + (1048*w^2 + 964*w +
187)*x^4 + (704*w^2 + 429*w + 885)*x^3 + (734*w^2 + 324*w + 1064)*x^2 + (584*w^2 + 173*w + 764)*x + 1137*w^2 + 1062*w + 488
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (7362050147360474146092222615551752561*t^8 - 2887927077786695655193880809156675159385369886876*t^7 - 776914130041737342667426261371161355283*t^6 - 868143322824458156883799372212*t^5 + 345376314295377362761*t^4 - 527037765806389034532*t^3 - 286334470911053128843*t^2 - 646155647189483991756*t + 1)//(1647212741*t^2 - 1647212742*t + 1)

F, w = FiniteField(1031, 3, "w")
Fx, x = F['x']
h = x^11 + (914*w^2 + 720*w + 481)*x^10 + (885*w^2 + 1014*w + 81)*x^9 + (233*w^2 + 375*w + 74)*x^8 + (553*w^2 + 943*w + 614)*x^7 + (859*w^2 + 839*w + 257)*x^6 + (468*w^2 + 1001*w + 719)*x^5 + (401*w^2 + 314*w + 904)*x^4 + (887*w^2 + 485*w + 152)*x^3 + (431*w^2 + 271*w + 880)*x^2 + (772*w^2 + 796*w + 34)*x + 754*w^2 + 50*w + 798
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (1580811109128228731410546902309489516545744951*t^10 - 813800654001425639685921255734206068228979211735522783511308794*t^9 + 449444084659606912454772079231228146124745876653766882*t^8 - 15190187582683035908685895719276535462730548*t^7 + 550948876461588767049091341518824678*t^6 - 368734148826518352827180896*t^5 + 502730583114061643477150858*t^4 - 12647688047323373391685108*t^3 + 341466168356269093810281742*t^2 - 564175277422082065245741754*t + 1)//(1095912791*t^2 - 1095912792*t + 1)

println("3")
F, w = FiniteField(821, 3, "w")
Fx, x = F['x']
h = x^3 + (744*w^2 + 809*w + 79)*x^2 + (112*w^2 + 569*w + 8)*x + 327*w^2 + 535*w + 139
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (553387661*t^2 - 40747*t + 1)//(553387661*t^2 - 553387662*t + 1)

F, w = FiniteField(409, 1, "w")
Fx, x = F['x']
h = x^7 + 295*x^6 + 37*x^5 + 188*x^4 + 34*x^3 + 242*x^2 + 386*x + 347
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (68417929*t^6 - 3178339*t^5 - 126381*t^4 + 17503*t^3 - 309*t^2 - 19*t + 1)//(409*t^2 - 410*t + 1)

F, w = FiniteField(1277, 2, "w")
Fx, x = F['x']
h = x^7 + (1016*w + 622)*x^6 + (353*w + 153)*x^5 + (1144*w + 1030)*x^4 + (382*w  + 458)*x^3 + (1246*w + 486)*x^2 + (574*w + 283)*x + 508*w + 716
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (4336560239433910489*t^6 - 3039553692657063*t^5 + 311030572899*t^4 + 2465521839*t^3 + 190731*t^2 - 1143*t + 1)//(1630729*t^2 - 1630730*t + 1)

F, w = FiniteField(19, 2, "w")
Fx, x = F['x']
h = x^3 + w^113*x^2 + w^305*x + w^286
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (361*t^2 + 33*t + 1)//(361*t^2 - 362*t + 1)

F, w = FiniteField(433, 2, "w")
Fx, x = F['x']
h = x^7 + w^104669*x^6 + w^112131*x^5 + w^153378*x^4 + w^59426*x^3 + w^180115*x^2 + w^42155*x + w^147638
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (6590636786811169*t^6 - 7628011151257*t^5 + 30633640221*t^4 - 109593473*t^3  + 163389*t^2 - 217*t + 1)//(187489*t^2 - 187490*t + 1)

F, w = FiniteField(2477, 2, "w")
Fx, x = F['x']
h = x^3 + (521*w + 1583)*x^2 + (420*w + 2033)*x + 2292*w + 445
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (6135529*t^2 - 2373*t + 1)//(6135529*t^2 - 6135530*t + 1)

F, w = FiniteField(2689, 1, "w")
Fx, x = F['x']
h = x^7 + 951*x^6 + 694*x^5 + 1691*x^4 + 2152*x^3 + 771*x^2 + 1707*x + 1028
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (19443408769*t^6 - 441073981*t^5 + 3310159*t^4 + 105209*t^3 + 1231*t^2 - 61*t + 1)//(2689*t^2 - 2690*t + 1)

F, w = FiniteField(2939, 2, "w")
Fx, x = F['x']
h = x^11 + (655*w + 854)*x^10 + (559*w + 2398)*x^9 + (2105*w + 697)*x^8 + (2102*w + 413)*x^7 + (21*w + 1266)*x^6 + (447*w + 1828)*x^5 + (2036*w + 1559)*x^4 + (519*w + 1285)*x^3 + (2454*w + 123)*x^2 + (371*w + 1847)*x + 1747*w  + 1615
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (48083476557715974406625985443652601*t^10 - 8043860600023962688488612791045*t^9 - 911517809191642715247652985*t^8 - 1085665518758974766013143*t^7 - 147704472015859087697*t^6 + 253473334834468013*t^5 - 17099935505657*t^4 - 14551162823*t^3 - 1414385*t^2 - 1445*t + 1)//(8637721*t^2 - 8637722*t + 1)

println("4")
F, w = FiniteField(3067, 1, "w")
Fx, x = F['x']
h = x^11 + 870*x^10 + 178*x^9 + 1523*x^8 + 2262*x^7 + 947*x^6 + 2682*x^5 + 1072*x^4 + 2481*x^3 + 2256*x^2 + 1931*x + 2180
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (271374402286940107*t^10 + 442410176535605*t^9 - 13126614302165*t^8 - 2061761291465*t^7 + 18851189753*t^6 + 25385961*t^5 + 6146459*t^4 - 219185*t^3 - 455*t^2 + 5*t + 1)//(3067*t^2 - 3068*t + 1)

F, w = FiniteField(1543, 1, "w")
Fx, x = F['x']
h = x^11 + 209*x^10 + 143*x^9 + 360*x^8 + 292*x^7 + 1225*x^6 + 93*x^5 + 1111*x^4 + 1257*x^3 + 190*x^2 + 1081*x + 734
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (8746405945515943*t^10 - 62352861568811*t^9 + 2391546154557*t^8 + 9359117419*t^7 + 208109039*t^6 + 62463971*t^5 + 134873*t^4 + 3931*t^3 + 651*t^2  - 11*t + 1)//(1543*t^2 - 1544*t + 1)

F, w = FiniteField(1481, 3, "w")
Fx, x = F['x']
h = x^5 + (892*w^2 + 224*w + 1135)*x^4 + (1317*w^2 + 1468*w + 388)*x^3 + (1343*w^2 + 875*w + 529)*x^2 + (497*w^2 + 1435*w + 1050)*x + 1080*w^2 + 505*w + 62
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (10551892331095904881*t^4 + 2519002202303689836150*t^3 - 1497383380988*t^2 +
775467090150*t + 1)//(3248367641*t^2 - 3248367642*t + 1)

F, w = FiniteField(1103, 1, "w")
Fx, x = F['x']
h = x^9 + 826*x^8 + 506*x^7 + 272*x^6 + 645*x^5 + 77*x^4 + 499*x^3 + 171*x^2 + 1086*x + 1054
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (1480137458881*t^8 + 100643979525*t^7 + 5227768873*t^6 + 207808509*t^5 + 7127923*t^4 + 188403*t^3 + 4297*t^2 + 75*t + 1)//(1103*t^2 - 1104*t + 1)

F, w = FiniteField(4003, 2, "w")
Fx, x = F['x']
h = x^9 + (3524*w + 225)*x^8 + (3474*w + 2228)*x^7 + (2122*w + 3934)*x^6 + (3545*w + 3443)*x^5 + (3790*w + 3936)*x^4 + (308*w + 1515)*x^3 + (2900*w + 1877)*x^2 + (2350*w + 1277)*x + 24*w + 3039
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (65930249741740391238661990561*t^8 + 19951048517115732842902921*t^7 + 5947199042245835152323*t^6 - 534750503449245541*t^5 - 114396148696387*t^4 - 33371829949*t^3 + 23161683*t^2 + 4849*t + 1)//(16024009*t^2 - 16024010*t + 1)

F, w = FiniteField(269, 3, "w")
Fx, x = F['x']
h = x^3 + (24*w^2 + 141*w + 260)*x^2 + (198*w^2 + 105*w + 19)*x + 139*w^2 + 98*w + 165
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (19465109*t^2 + 34415*t + 1)//(19465109*t^2 - 19465110*t + 1)

F, w = FiniteField(3527, 1, "w")
Fx, x = F['x']
h = x^11 + 724*x^10 + 2161*x^9 + 319*x^8 + 1011*x^7 + 1361*x^6 + 652*x^5 + 792*x^4 + 2738*x^3 + 3266*x^2 + 3120*x + 3114
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (545792166732066407*t^10 + 3559177724649143*t^9 + 109994434926781*t^8 + 4303785481859*t^7 + 53388301283*t^6 + 643296221*t^5 + 15137029*t^4 + 345971*t^3  + 2507*t^2 + 23*t + 1)//(3527*t^2 - 3528*t + 1)

F, w = FiniteField(2347, 1, "w")
Fx, x = F['x']
h = x^7 + 1208*x^6 + 2068*x^5 + 875*x^4 + 120*x^3 + 2000*x^2 + 1676*x + 2178
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (12928235923*t^6 - 302962495*t^5 + 10948755*t^4 - 151485*t^3 + 4665*t^2 - 55*t + 1)//(2347*t^2 - 2348*t + 1)

F, w = FiniteField(3361, 2, "w")
Fx, x = F['x']
h = x^7 + (1183*w + 669)*x^6 + (445*w + 2093)*x^5 + (871*w + 1085)*x^4 + (228*w  + 395)*x^3 + (756*w + 1963)*x^2 + (2106*w + 3335)*x + 1045*w + 263
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (1441488144258094484161*t^6 - 213486290389923593*t^5 + 34567770225211*t^4 + 37658838161*t^3 + 3060091*t^2 - 1673*t + 1)//(11296321*t^2 - 11296322*t + 1)

F, w = FiniteField(449, 3, "w")
Fx, x = F['x']
h = x^5 + (429*w^2 + 214*w + 289)*x^4 + (29*w^2 + 84*w + 360)*x^3 + (343*w^2 + 435*w + 309)*x^2 + (145*w^2 + 233*w + 130)*x + 254*w^2 + 309*w + 357
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (8193662024284801*t^4 - 424682302057926436*t^3 + 660591471*t^2 - 4691644964*t + 1)//(90518849*t^2 - 90518850*t + 1)

F, w = FiniteField(727, 3, "w")
Fx, x = F['x']
h = x^3 + (289*w^2 + 505*w + 455)*x^2 + (412*w^2 + 560*w + 456)*x + 85*w^2 + 314*w + 173
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (384240583*t^2 + 227335*t + 1)//(384240583*t^2 - 384240584*t + 1)

F, w = FiniteField(281, 1, "w")
Fx, x = F['x']
h = x^5 + 151*x^4 + 54*x^3 + 17*x^2 + 65*x + 44
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (78961*t^4 + 5339*t^3 + 473*t^2 + 19*t + 1)//(281*t^2 - 282*t + 1)

println("5")
F, w = FiniteField(971, 3, "w")
Fx, x = F['x']
h = x^3 + (840*w^2 + 711*w + 442)*x^2 + (567*w^2 + 138*w + 286)*x + 315*w^2 + 194*w + 777
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (915498611*t^2 + 200420*t + 1)//(915498611*t^2 - 915498612*t + 1)

F, w = FiniteField(839, 1, "w")
Fx, x = F['x']
h = x^7 + 645*x^6 + 243*x^5 + 677*x^4 + 321*x^3 + 295*x^2 + 764*x + 339
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (590589719*t^6 + 37307813*t^5 + 891857*t^4 + 13485*t^3 + 1063*t^2 + 53*t + 1)//(839*t^2 - 840*t + 1)

F, w = FiniteField(3967, 3, "w")
Fx, x = F['x']
h = x^5 + (3291*w^2 + 639*w + 2329)*x^4 + (3528*w^2 + 3620*w + 108)*x^3 + (3122*w^2 + 3679*w + 2864)*x^2 + (502*w^2 + 3668*w + 3256)*x + 2002*w^2 + 3874*w + 92
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (3897384044323082035969*t^4 - 446364110437844122454078*t^3 - 50406615376589*t^2 - 7149944435906*t + 1)//(62429032063*t^2 - 62429032064*t + 1)

F, w = FiniteField(727, 1, "w")
Fx, x = F['x']
h = x^5 + 76*x^4 + 454*x^3 + 319*x^2 + 237*x + 517
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (528529*t^4 + 727*t^3 - 47*t^2 + t + 1)//(727*t^2 - 728*t + 1)

F, w = FiniteField(1499, 1, "w")
Fx, x = F['x']
h = x^5 + 291*x^4 + 790*x^3 + 399*x^2 + 386*x + 1384
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (2247001*t^4 - 133411*t^3 + 4589*t^2 - 89*t + 1)//(1499*t^2 - 1500*t + 1)

F, w = FiniteField(2221, 2, "w")
Fx, x = F['x']
h = x^5 + (1474*w + 292)*x^4 + (702*w + 1137)*x^3 + (1844*w + 865)*x^2 + (364*w  + 506)*x + 778*w + 20
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (24332920331281*t^4 - 3152085399*t^3 + 7252693*t^2 - 639*t + 1)//(4932841*t^2 - 4932842*t + 1)

F, w = FiniteField(1499, 3, "w")
Fx, x = F['x']
h = x^5 + (1018*w^2 + 279*w + 356)*x^4 + (921*w^2 + 696*w + 990)*x^3 + (1441*w^2 + 1360*w + 1458)*x^2 + (438*w^2 + 879*w + 1265)*x + 916*w^2 + 101*w + 224
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (11345138370033741001*t^4 - 2858888872143418575405*t^3 - 2368618767060*t^2 -
848774602095*t + 1)//(3368254499*t^2 - 3368254500*t + 1)

F, w = FiniteField(2617, 2, "w")
Fx, x = F['x']
h = x^3 + (2321*w + 2338)*x^2 + (1447*w + 2416)*x + 2439*w + 1157
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (6848689*t^2 - 3481*t + 1)//(6848689*t^2 - 6848690*t + 1)

F, w = FiniteField(3643, 3, "w")
Fx, x = F['x']
h = x^3 + (1702*w^2 + 2228*w + 1678)*x^2 + (2417*w^2 + 1656*w + 218)*x + 3004*w^2 + 2515*w + 656
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (48347888707*t^2 - 5362688*t + 1)//(48347888707*t^2 - 48347888708*t + 1)

F, w = FiniteField(23, 1, "w")
Fx, x = F['x']
h = x^5 + 3*x^4 + 10*x^3 + 4*x^2 + 13*x + 13
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (529*t^4 + 207*t^3 + 45*t^2 + 9*t + 1)//(23*t^2 - 24*t + 1)

F, w = FiniteField(409, 2, "w")
Fx, x = F['x']
h = x^11 + w^122939*x^10 + w^150180*x^9 + w^142806*x^8 + w^107228*x^7 + w^112437*x^6 + w^122023*x^5 + w^43918*x^4 + w^156005*x^3 + w^85596*x^2 + w^96949*x + w^116510
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (130988473210595027479940401*t^10 - 627218674216956002244321*t^9 + 2515206590820311359161*t^8 - 6313277887822299569*t^7 + 15868809877059211*t^6 - 34617421570881*t^5 + 94863193531*t^4 - 225611729*t^3 + 537321*t^2 - 801*t + 1)//(167281*t^2 - 167282*t + 1)

F, w = FiniteField(3571, 1, "w")
Fx, x = F['x']
h = x^9 + 2283*x^8 + 2311*x^7 + 1691*x^6 + 2656*x^5 + 2781*x^4 + 1169*x^3 + 2534*x^2 + 1112*x + 1221
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (162614549665681*t^8 - 500912922521*t^7 - 36840646449*t^6 + 110318903*t^5 + 15257985*t^4 + 30893*t^3 - 2889*t^2 - 11*t + 1)//(3571*t^2 - 3572*t + 1)

F, w = FiniteField(2137, 3, "w")
Fx, x = F['x']
h = x^9 + (1700*w^2 + 190*w + 1969)*x^8 + (1134*w^2 + 799*w + 2132)*x^7 + (1164*w^2 + 649*w + 847)*x^6 + (24*w^2 + 1183*w + 1186)*x^5 + (1784*w^2 + 612*w  + 647)*x^4 + (1939*w^2 + 1305*w + 70)*x^3 + (1632*w^2 + 887*w + 1494)*x^2 + (1404*w^2 + 1374*w + 593)*x + 953*w^2 + 1898*w + 112
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (9070981181587636113413375942978212382881*t^8 - 61984352566250254818476987033801418001342669949109203*t^7 + 9250686792858669560314413207333737674531242*t^6 - 25552742062822205653470240270429*t^5 - 25779151816222404464096*t^4 - 2618327364278128354293*t^3 + 97128536280436558252938*t^2 - 66687029062258809947339*t + 1)//(9759185353*t^2 - 9759185354*t + 1)

println("6")
F, w = FiniteField(3623, 2, "w")
Fx, x = F['x']
h = x^7 + (668*w + 2648)*x^6 + (3434*w + 3198)*x^5 + (3575*w + 932)*x^4 + (2117*w + 2874)*x^3 + (933*w + 2487)*x^2 + (1583*w + 901)*x + 3238*w + 3152
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (2261569841987303444689*t^6 + 218987278668818711*t^5 + 84218805673351*t^4 + 86138066763*t^3 + 6416119*t^2 + 1271*t + 1)//(13126129*t^2 - 13126130*t + 1)

F, w = FiniteField(1373, 2, "w")
Fx, x = F['x']
h = x^9 + (518*w + 1350)*x^8 + (1086*w + 468)*x^7 + (428*w + 18)*x^6 + (313*w + 915)*x^5 + (1144*w + 432)*x^4 + (464*w + 350)*x^3 + (1000*w + 607)*x^2 + (1296*w + 1313)*x + 385*w + 212
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (12628864335244989661982881*t^8 + 73691247489002018579*t^7 + 7118499611549479997*t^6 - 1185175393688573*t^5 + 2965161428571*t^4 - 628697237*t^3 + 2003117*t^2 + 11*t + 1)//(1885129*t^2 - 1885130*t + 1)

F, w = FiniteField(1697, 2, "w")
Fx, x = F['x']
h = x^5 + (1028*w + 612)*x^4 + (1535*w + 1282)*x^3 + (849*w + 1679)*x^2 + (1206*w + 726)*x + 1209*w + 1209
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (8293299876481*t^4 - 5036785941*t^3 + 566429*t^2 - 1749*t + 1)//(2879809*t^2  - 2879810*t + 1)

F, w = FiniteField(587, 1, "w")
Fx, x = F['x']
h = x^11 + 121*x^10 + 460*x^9 + 345*x^8 + 452*x^7 + 397*x^6 + 94*x^5 + 32*x^4 + 495*x^3 + 269*x^2 + 434*x + 371
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (69693216111707*t^10 - 356183387283*t^9 + 171720440547*t^8 - 3630034415*t^7  + 122951259*t^6 - 11634983*t^5 + 209457*t^4 - 10535*t^3 + 849*t^2 - 3*t + 1)//(587*t^2 - 588*t + 1)

F, w = FiniteField(1091, 3, "w")
Fx, x = F['x']
h = x^3 + (817*w^2 + 969*w + 989)*x^2 + (629*w^2 + 863*w + 754)*x + 988*w^2 + 521*w + 684
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (1298596571*t^2 + 534996*t + 1)//(1298596571*t^2 - 1298596572*t + 1)

F, w = FiniteField(439, 2, "w")
Fx, x = F['x']
h = x^7 + w^77144*x^6 + w^41308*x^5 + w^190669*x^4 + w^141917*x^3 + w^58282*x^2  + w^163147*x + w^47773
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (7157924635221361*t^6 - 5088369586217*t^5 + 50406755713*t^4 + 5530303*t^3 + 261553*t^2 - 137*t + 1)//(192721*t^2 - 192722*t + 1)

F, w = FiniteField(887, 3, "w")
Fx, x = F['x']
h = x^7 + (496*w^2 + 183*w + 490)*x^6 + (760*w^2 + 514*w + 234)*x^5 + (774*w^2 +
215*w + 314)*x^4 + (61*w^2 + 556*w + 278)*x^3 + (823*w^2 + 486*w + 671)*x^2 + (563*w^2 + 343*w + 44)*x + 536*w^2 + 126*w + 347
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (339869801983506966182620727*t^6 + 53212510551263688606810070747914855*t^5 -
114401173594912434380801567*t^4 - 65063661234156728*t^3 - 163930445917938889*t^2 + 109262725689403095*t + 1)//(697864103*t^2 - 697864104*t + 1)

F, w = FiniteField(719, 2, "w")
Fx, x = F['x']
h = x^5 + w^420327*x^4 + w^309150*x^3 + w^180578*x^2 + w^468746*x + w^349318
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (267248675521*t^4 + 269336681*t^3 + 883239*t^2 + 521*t + 1)//(516961*t^2 - 516962*t + 1)

F, w = FiniteField(439, 1, "w")
Fx, x = F['x']
h = x^9 + 350*x^8 + 216*x^7 + 41*x^6 + 259*x^5 + 302*x^4 + 166*x^3 + 305*x^2 + 292*x + 373
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (37141383841*t^8 - 423022595*t^7 - 47602087*t^6 + 2929447*t^5 + 37197*t^4 + 6673*t^3 - 247*t^2 - 5*t + 1)//(439*t^2 - 440*t + 1)

F, w = FiniteField(2221, 3, "w")
Fx, x = F['x']
h = x^7 + (923*w^2 + 1188*w + 358)*x^6 + (62*w^2 + 236*w + 1104)*x^5 + (699*w^2  + 288*w + 1628)*x^4 + (551*w^2 + 85*w + 1944)*x^3 + (928*w^2 + 252*w + 1549)*x^2 + (343*w^2 + 845*w + 2208)*x + 911*w^2 + 77*w + 514
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (1315034137315447984998151234381*t^6 + 4631381863665247863090530970231540019316*t^5 + 490806819019856328982356806126*t^4 + 55769505187575753914*t^3 + 44798648505898997366*t^2 + 38585065279780344596*t + 1)//(10955839861*t^2 - 10955839862*t + 1)

F, w = FiniteField(2689, 3, "w")
Fx, x = F['x']
h = x^7 + (2147*w^2 + 2112*w + 47)*x^6 + (1728*w^2 + 1791*w + 2643)*x^5 + (107*w^2 + 2071*w + 456)*x^4 + (98*w^2 + 2592*w + 1591)*x^3 + (1339*w^2 + 511*w  + 2362)*x^2 + (759*w^2 + 2294*w + 2082)*x + 172*w^2 + 463*w + 1421
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (7350505722193943575380497620609*t^6 - 51294792118124056808426810386629963955853*t^5 + 503089926939031109508775359959*t^4 + 11679828641312118916*t^3 + 25874574408019591511*t^2 - 135683944556658674573*t + 1)//(19443408769*t^2 - 19443408770*t + 1)

println("8")
F, w = FiniteField(1051, 1, "w")
Fx, x = F['x']
h = x^7 + 229*x^6 + 121*x^5 + 285*x^4 + 504*x^3 + 925*x^2 + 902*x + 467
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (1160935651*t^6 - 3313803*t^5 - 358391*t^4 + 15071*t^3 - 341*t^2 - 3*t + 1)//(1051*t^2 - 1052*t + 1)

F, w = FiniteField(1571, 2, "w")
Fx, x = F['x']
h = x^5 + (377*w + 557)*x^4 + (1423*w + 1047)*x^3 + (705*w + 1493)*x^2 + (477*w  + 188)*x + 1204*w + 1130
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (6091226377681*t^4 - 629350455*t^3 - 1076129*t^2 - 255*t + 1)//(2468041*t^2 -
2468042*t + 1)

F, w = FiniteField(317, 3, "w")
Fx, x = F['x']
h = x^9 + (14*w^2 + 314*w + 217)*x^8 + (33*w^2 + 209*w + 124)*x^7 + (157*w^2 + 161*w + 285)*x^6 + (264*w^2 + 186*w + 123)*x^5 + (243*w^2 + 266*w + 191)*x^4 + (135*w^2 + 226*w + 156)*x^3 + (231*w^2 + 212*w + 109)*x^2 + (286*w^2 + 93*w + 135)*x + 91*w^2 + 62*w + 75
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (1029701028696997844179291768561*t^8 + 4860417293343587342043796078509879560151*t^7 - 130090272491675863633814044807895*t^6 + 1028992442221948883373692*t^5 - 140906887447201104*t^4 + 32302370814350284*t^3 - 128200361577249455*t^2 + 150362728355052483*t + 1)//(31855013*t^2 - 31855014*t + 1)

F, w = FiniteField(263, 3, "w")
Fx, x = F['x']
h = x^9 + (207*w^2 + 237*w + 219)*x^8 + (112*w^2 + 85*w + 19)*x^7 + (225*w^2 + 141*w + 76)*x^6 + (88*w^2 + 5*w + 259)*x^5 + (96*w^2 + 49*w + 47)*x^4 + (230*w^2 + 206*w + 80)*x^3 + (164*w^2 + 83*w + 247)*x^2 + (30*w^2 + 152*w + 11)*x + 72*w^2 + 140*w + 55
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (109513833574845676773925608481*t^8 + 156369500105987944353082600798462236210*t^7 - 6283229941366914730549579855000*t^6 + 546001992739725036221978*t^5 - 35856557526503149*t^4 + 30014214522886774*t^3 - 18986655152095000*t^2 + 25974686308926270*t + 1)//(18191447*t^2 - 18191448*t + 1)

F, w = FiniteField(3511, 2, "w")
Fx, x = F['x']
h = x^5 + (2562*w + 1210)*x^4 + (2091*w + 1144)*x^3 + (529*w + 2712)*x^2 + (2784*w + 1345)*x + 1321*w + 2002
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (151957912148641*t^4 + 24272101249*t^3 + 4772355*t^2 + 1969*t + 1)//(12327121*t^2 - 12327122*t + 1)

F, w = FiniteField(4013, 3, "w")
Fx, x = F['x']
h = x^5 + (2280*w^2 + 2866*w + 61)*x^4 + (1792*w^2 + 2570*w + 2823)*x^3 + (1299*w^2 + 3208*w + 3892)*x^2 + (1714*w^2 + 420*w + 3060)*x + 3811*w^2 + 3613*w + 3689
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (4176523779023555858809*t^4 - 592784509030926604565713*t^3 - 6184156749985*t^2 - 9172534770029*t + 1)//(64626030197*t^2 - 64626030198*t + 1)

F, w = FiniteField(2621, 1, "w")
Fx, x = F['x']
h = x^5 + 1187*x^4 + 2016*x^3 + 520*x^2 + 2264*x + 1985
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (6869641*t^4 - 138913*t^3 + 4117*t^2 - 53*t + 1)//(2621*t^2 - 2622*t + 1)

F, w = FiniteField(787, 1, "w")
Fx, x = F['x']
h = x^9 + 447*x^8 + 691*x^7 + 358*x^6 + 203*x^5 + 356*x^4 + 188*x^3 + 235*x^2 + 144*x + 330
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (383617958161*t^8 + 1462330209*t^7 + 327646201*t^6 + 449377*t^5 - 119405*t^4 + 571*t^3 + 529*t^2 + 3*t + 1)//(787*t^2 - 788*t + 1)

F, w = FiniteField(317, 3, "w")
Fx, x = F['x']
h = x^9 + (169*w^2 + 61*w + 148)*x^8 + (102*w^2 + 262*w + 48)*x^7 + (185*w^2 + 136*w + 88)*x^6 + (273*w^2 + 22*w + 109)*x^5 + (51*w^2 + 270*w + 185)*x^4 + (34*w^2 + 235*w + 212)*x^3 + (171*w^2 + 286*w + 54)*x^2 + (29*w^2 + 268*w + 308)*x + 273*w^2 + 193*w + 239
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (1029701028696997844179291768561*t^8 + 4086925536579582300537812543764373421477*t^7 + 58567888587066016602473854011876*t^6 + 1608720881340483660494446*t^5 - 154253357341000832*t^4 + 50501341228160342*t^3 + 57717032564124804*t^2 + 126433850670731241*t + 1)//(31855013*t^2 - 31855014*t + 1)

F, w = FiniteField(2113, 2, "w")
Fx, x = F['x']
h = x^11 + (1229*w + 1551)*x^10 + (920*w + 599)*x^9 + (563*w + 401)*x^8 + (112*w + 1912)*x^7 + (1229*w + 1322)*x^6 + (120*w + 32)*x^5 + (225*w + 1150)*x^4 + (1119*w + 359)*x^3 + (236*w + 1186)*x^2 + (2035*w + 2032)*x + 1956*w + 500
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (1774168934478333483994575367774849*t^10 - 424789410372034587767071727149*t^9 - 106158146106026311965488321*t^8 + 55032346723001792035831*t^7 - 7018406255715817395*t^6 - 19119578177169025*t^5 - 1571952827955*t^4 + 2760705271*t^3 - 1192769*t^2 - 1069*t + 1)//(4464769*t^2 - 4464770*t + 1)

F, w = FiniteField(401, 1, "w")
Fx, x = F['x']
h = x^11 + 140*x^10 + 177*x^9 + 81*x^8 + 212*x^7 + 62*x^6 + 125*x^5 + 17*x^4 + 191*x^3 + 185*x^2 + 59*x + 223
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (10368641602001*t^10 + 232712654409*t^9 + 41332449841*t^8 + 969147627*t^7 + 124790799*t^6 + 3107865*t^5 + 311199*t^4 + 6027*t^3 + 641*t^2 + 9*t + 1)//(401*t^2 - 402*t + 1)

println("9")
F, w = FiniteField(881, 3, "w")
Fx, x = F['x']
h = x^7 + (680*w^2 + 20*w + 63)*x^6 + (699*w^2 + 663*w + 745)*x^5 + (76*w^2 + 657*w + 442)*x^4 + (271*w^2 + 860*w + 683)*x^3 + (146*w^2 + 452*w + 511)*x^2 + (870*w^2 + 655*w + 531)*x + 156*w^2 + 9*w + 807
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (319729843950098261779694321*t^6 - 81230104230783079318177220669411788*t^5 +
31123769269075334923621328*t^4 - 209977030964722562*t^3 + 45516039102374608*t^2  - 173724695858806348*t + 1)//(683797841*t^2 - 683797842*t + 1)

F, w = FiniteField(1087, 3, "w")
Fx, x = F['x']
h = x^3 + (74*w^2 + 232*w + 539)*x^2 + (406*w^2 + 112*w + 489)*x + 30*w^2 + 351*w + 749
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (1284365503*t^2 - 51857*t + 1)//(1284365503*t^2 - 1284365504*t + 1)

F, w = FiniteField(233, 2, "w")
Fx, x = F['x']
h = x^3 + w^14051*x^2 + w^14161*x + w^20112
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (54289*t^2 + 77*t + 1)//(54289*t^2 - 54290*t + 1)

F, w = FiniteField(2861, 3, "w")
Fx, x = F['x']
h = x^11 + (2273*w^2 + 583*w + 2257)*x^10 + (1667*w^2 + 2208*w + 2084)*x^9 + (407*w^2 + 98*w + 2480)*x^8 + (735*w^2 + 945*w + 1843)*x^7 + (2036*w^2 + 1267*w  + 1480)*x^6 + (2477*w^2 + 1547*w + 2364)*x^5 + (2198*w^2 + 2179*w + 561)*x^4 + (142*w^2 + 374*w + 9)*x^3 + (2128*w^2 + 1980*w + 1064)*x^2 + (792*w^2 + 1391*w +
13)*x + 1976*w^2 + 1901*w + 1633
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (7043165070782311691685997570793614007659822563580901*t^10 - 1220872623399464119465776318774572292118436251520443076779006721542563307*t^9 + 2818889077402178928081512595331061829598804623637662398963041*t^8 - 1413459860490563428820505052514320106966609473947493*t^7 + 34467819603749257755363829021556883060532*t^6 + 2609273470455726043719942142401*t^5 + 1471838767602223249107404659172*t^4 - 2577367412083308345821805998413*t^3 + 219491277679515581770540809701*t^2 - 4059345920439714553204953480667*t + 1)//(23418203381*t^2 - 23418203382*t + 1)

F, w = FiniteField(2917, 2, "w")
Fx, x = F['x']
h = x^7 + (2565*w + 1435)*x^6 + (2212*w + 389)*x^5 + (223*w + 246)*x^4 + (2751*w + 2453)*x^3 + (774*w + 2587)*x^2 + (1563*w + 694)*x + 2020*w + 2452
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (616053706317543799369*t^6 + 187157081357019785*t^5 + 84790661949439*t^4 + 42194774375*t^3 + 9964951*t^2 + 2585*t + 1)//(8508889*t^2 - 8508890*t + 1)

F, w = FiniteField(191, 3, "w")
Fx, x = F['x']
h = x^7 + (170*w^2 + 35*w + 43)*x^6 + (127*w^2 + 58*w + 161)*x^5 + (2*w^2 + 74*w + 169)*x^4 + (35*w^2 + 145*w + 109)*x^3 + (81*w^2 + 184*w + 54)*x^2 + (90*w^2 + 127*w + 95)*x + 121*w^2 + 75*w + 83
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (338298681559573317311*t^6 + 869544889294195681391498813*t^5 - 147214560534781453232*t^4 + 5890713871144*t^3 - 21127624282192*t^2 + 17909844015293*t + 1)//(6967871*t^2 - 6967872*t + 1)

F, w = FiniteField(3761, 1, "w")
Fx, x = F['x']
h = x^5 + 3437*x^4 + 945*x^3 + 1965*x^2 + 808*x + 3022
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (14145121*t^4 - 214377*t^3 + 3797*t^2 - 57*t + 1)//(3761*t^2 - 3762*t + 1)

F, w = FiniteField(163, 2, "w")
Fx, x = F['x']
h = x^11 + w^414*x^10 + w^5117*x^9 + w^25774*x^8 + w^13684*x^7 + w^18367*x^6 + w^34*x^5 + w^1850*x^4 + w^20188*x^3 + w^11250*x^2 + w^25654*x + w^22503
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (13239635967018160063849*t^10 + 224738447857472625571*t^9 + 2402881684225779053*t^8 + 19688794581844017*t^7 + 143755907027123*t^6 + 936608474651*t^5 + 5410663067*t^4 + 27891297*t^3 + 128117*t^2 + 451*t + 1)//(26569*t^2 - 26570*t + 1)

F, w = FiniteField(1223, 2, "w")
Fx, x = F['x']
h = x^11 + (34*w + 115)*x^10 + (602*w + 585)*x^9 + (714*w + 1018)*x^8 + (718*w +
418)*x^7 + (204*w + 1034)*x^6 + (610*w + 1162)*x^5 + (804*w + 79)*x^4 + (895*w +
873)*x^3 + (712*w + 1183)*x^2 + (1089*w + 637)*x + 889*w + 16
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (7486254210671078599698577569649*t^10 - 4689766792914224868219822697*t^9 + 10566010591630834476374285*t^8 - 8283401853982636000241*t^7 + 7187585762108209841*t^6 - 7139065757032323*t^5 + 4805406435329*t^4 - 3702566801*t^3 + 3157565*t^2 - 937*t + 1)//(1495729*t^2 - 1495730*t + 1)

F, w = FiniteField(1823, 3, "w")
Fx, x = F['x']
h = x^9 + (274*w^2 + 972*w + 519)*x^8 + (370*w^2 + 1580*w + 273)*x^7 + (1177*w^2 + 1815*w + 307)*x^6 + (1399*w^2 + 232*w + 1137)*x^5 + (1201*w^2 + 145*w + 539)*x^4 + (804*w^2 + 1513*w + 1437)*x^3 + (1055*w^2 + 825*w + 241)*x^2 + (964*w^2 + 252*w + 1678)*x + 1173*w^2 + 212*w + 948
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (1347224660546903559004075090801595003521*t^8 + 666544962758332595701935664714672551173639888408631*t^7 + 219776776556371561264264901437788155547389*t^6 + 120708391651322354685634896742436*t^5 + 14847601858941677107526*t^4 + 19924042403339914466908*t^3 + 5987724190039305523901*t^2 + 2997432644407443733737*t + 1)//(6058428767*t^2 - 6058428768*t + 1)

F, w = FiniteField(1597, 3, "w")
Fx, x = F['x']
h = x^5 + (1123*w^2 + 643*w + 1234)*x^4 + (1063*w^2 + 269*w + 1400)*x^3 + (1027*w^2 + 979*w + 20)*x^2 + (1076*w^2 + 1371*w + 215)*x + 1416*w^2 + 633*w + 1230
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (16589354847268067929*t^4 - 11626252962331926184280*t^3 + 373244522439*t^2 -
2854466954360*t + 1)//(4073003173*t^2 - 4073003174*t + 1)

F, w = FiniteField(461, 3, "w")
Fx, x = F['x']
h = x^11 + (109*w^2 + 294*w + 216)*x^10 + (216*w^2 + 295*w + 13)*x^9 + (418*w^2  + 11*w + 327)*x^8 + (357*w^2 + 378*w + 229)*x^7 + (241*w^2 + 128*w + 396)*x^6 + (91*w^2 + 74*w + 213)*x^5 + (128*w^2 + 92*w + 228)*x^4 + (389*w^2 + 444*w + 230)*x^3 + (345*w^2 + 456*w + 408)*x^2 + (371*w^2 + 111*w + 402)*x + 429*w^2 + 439*w + 121
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (9026385569865527818586492247033357304901*t^10 + 2628082468600632665982599393975167599966125645751730230*t^9 - 89255809844061000013011099314478053141703169480*t^8 + 545572177698281040310783600826732259419*t^7 - 43204749828960641784148621240039*t^6 + 386406558075448483866016*t^5 - 440989976827816477660619*t^4 + 56839030600710794467379*t^3 - 94913538840175318882280*t^2 + 28525146561017539044630*t + 1)//(97972181*t^2 - 97972182*t + 1)

F, w = FiniteField(2003, 1, "w")
Fx, x = F['x']
h = x^5 + 1945*x^4 + 327*x^3 + 1106*x^2 + 1363*x + 1279
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (4012009*t^4 - 22033*t^3 + 655*t^2 - 11*t + 1)//(2003*t^2 - 2004*t + 1)

F, w = FiniteField(1777, 1, "w")
Fx, x = F['x']
h = x^3 + 495*x^2 + 1503*x + 721
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (1777*t^2 - 37*t + 1)//(1777*t^2 - 1778*t + 1)

F, w = FiniteField(2153, 2, "w")
Fx, x = F['x']
h = x^7 + (1240*w + 1185)*x^6 + (321*w + 1876)*x^5 + (1747*w + 1540)*x^4 + (1210*w + 1969)*x^3 + (1369*w + 1495)*x^2 + (180*w + 1102)*x + 334*w + 1305
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (99601110118185722929*t^6 - 73421135712909177*t^5 + 51605790532777*t^4 - 21148894805*t^3 + 11132953*t^2 - 3417*t + 1)//(4635409*t^2 - 4635410*t + 1)

F, w = FiniteField(2003, 3, "w")
Fx, x = F['x']
h = x^5 + (1699*w^2 + 1881*w + 1385)*x^4 + (1289*w^2 + 958*w + 840)*x^3 + (626*w^2 + 1344*w + 1067)*x^2 + (718*w^2 + 1303*w + 1249)*x + 1534*w^2 + 1755*w  + 1223
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (64578164324862916729*t^4 + 3994067019090246478328*t^3 + 6703412288564*t^2 +
497018437864*t + 1)//(8036054027*t^2 - 8036054028*t + 1)

F, w = FiniteField(3673, 2, "w")
Fx, x = F['x']
h = x^7 + (2502*w + 548)*x^6 + (2410*w + 3289)*x^5 + (3468*w + 1334)*x^4 + (3163*w + 517)*x^3 + (2314*w + 1983)*x^2 + (2166*w + 86)*x + 807*w + 924
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (2455418762466771035089*t^6 - 537461253080820073*t^5 + 347116247271187*t^4 -
38501971229*t^3 + 25729603*t^2 - 2953*t + 1)//(13490929*t^2 - 13490930*t + 1)

F, w = FiniteField(709, 3, "w")
Fx, x = F['x']
h = x^3 + (666*w^2 + 469*w + 692)*x^2 + (432*w^2 + 480*w + 90)*x + 222*w^2 + 147*w + 349
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (356400829*t^2 - 90329*t + 1)//(356400829*t^2 - 356400830*t + 1)

F, w = FiniteField(1063, 3, "w")
Fx, x = F['x']
h = x^3 + (52*w^2 + 490*w + 449)*x^2 + (316*w^2 + 617*w + 610)*x + 554*w^2 + 130*w + 367
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (1201157047*t^2 - 547931*t + 1)//(1201157047*t^2 - 1201157048*t + 1)

F, w = FiniteField(3539, 2, "w")
Fx, x = F['x']
h = x^7 + (2528*w + 223)*x^6 + (343*w + 394)*x^5 + (495*w + 1881)*x^4 + (686*w +
1054)*x^3 + (3504*w + 2019)*x^2 + (2164*w + 1286)*x + 1320*w + 829
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (1964641781473010672761*t^6 - 743376724938270899*t^5 + 296400466996373*t^4 -
87544177871*t^3 + 23665613*t^2 - 4739*t + 1)//(12524521*t^2 - 12524522*t + 1)

F, w = FiniteField(439, 3, "w")
Fx, x = F['x']
h = x^7 + (140*w^2 + 49*w + 387)*x^6 + (320*w^2 + 86*w + 317)*x^5 + (170*w^2 + 286*w + 180)*x^4 + (318*w^2 + 77*w + 317)*x^3 + (260*w^2 + 205*w + 45)*x^2 + (121*w^2 + 215*w + 120)*x + 196*w^2 + 223*w + 405
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (605592770801153705930359*t^6 - 20077038140727331241210038285317*t^5 + 45045920924516041784847*t^4 + 1328360532655167*t^3 + 532429253861913*t^2 - 2804868612605397*t + 1)//(84604519*t^2 - 84604520*t + 1)

F, w = FiniteField(193, 3, "w")
Fx, x = F['x']
h = x^9 + (44*w^2 + 173*w + 69)*x^8 + (78*w^2 + 32*w + 68)*x^7 + (190*w^2 + 63*w + 10)*x^6 + (161*w^2 + 166*w + 182)*x^5 + (88*w^2 + 155*w + 176)*x^4 + (15*w^2 +
134*w + 112)*x^3 + (176*w^2 + 19*w + 172)*x^2 + (121*w^2 + 157*w + 110)*x + 142*w^2 + 22*w + 124
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (2671084997624767126594464001*t^8 + 206158268717401446026650487789185388980 *t^7 - 37299900721699588926093863742426*t^6 + 6072741171087259071838934*t^5 - 184581254122960326*t^4 + 844720131039058262*t^3 - 721711826185402074*t^2 + 554861992841351860*t + 1)//(7189057*t^2 - 7189058*t + 1)

F, w = FiniteField(1901, 2, "w")
Fx, x = F['x']
h = x^11 + (1428*w + 574)*x^10 + (251*w + 360)*x^9 + (1101*w + 1559)*x^8 + (458*w + 1430)*x^7 + (437*w + 807)*x^6 + (938*w + 9)*x^5 + (605*w + 656)*x^4 + (1162*w + 1645)*x^3 + (318*w + 1382)*x^2 + (1724*w + 753)*x + 997*w + 308
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (616341156097605195517044242469001*t^10 + 320467295323511217794373882679*t^9 + 495198140499251084446560477*t^8 + 231926665662407430398493*t^7 + 205438821979087510689*t^6 + 81787892620168169*t^5 + 56848404762489*t^4 + 17759151693*t^3 + 10492677*t^2 + 1879*t + 1)//(3613801*t^2 - 3613802*t + 1)

F, w = FiniteField(2833, 1, "w")
Fx, x = F['x']
h = x^5 + 716*x^4 + 1401*x^3 + 421*x^2 + 1376*x + 1791
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (8025889*t^4 + 195477*t^3 + 5225*t^2 + 69*t + 1)//(2833*t^2 - 2834*t + 1)

F, w = FiniteField(3391, 3, "w")
Fx, x = F['x']
h = x^7 + (310*w^2 + 1343*w + 612)*x^6 + (1084*w^2 + 2489*w + 891)*x^5 + (1742*w^2 + 908*w + 1538)*x^4 + (3056*w^2 + 2135*w + 3102)*x^3 + (781*w^2 + 2216*w + 2923)*x^2 + (2186*w^2 + 236*w + 1956)*x + 2714*w^2 + 2101*w + 1321
Z = ZetaFunction(2, h)
t = gen(parent(numerator(Z)))
@test Z == (59285721289372796818823439202111*t^6 - 336193177966565513317683654354356025731458*t^5 + 24947017936276573819943512457852*t^4 + 119168565250670412020*t^3 + 639786791784181038212*t^2 - 221117012405474961538*t + 1)//(38992705471*t^2 - 38992705472*t + 1)

# Some previously bad cases
F, w = FiniteField(379, 1, "l")
Fx, x = F["x"]
h = x^7 + x + 1
Z = ZetaFunction(3, x^7+x+ 1)
t = gen(parent(numerator(Z)))
@test Z == (2963706958323721*t^12 - 78198072778990*t^11 - 7077028750183*t^10 + 414995654997*t^9 - 15660460025*t^8 - 620201285*t^7 + 83531230*t^6 - 1636415*t^5 - 109025*t^4 + 7623*t^3 - 343*t^2 - 10*t + 1)//(379*t^2 - 380*t + 1)

F, w = FiniteField(fmpz(379), 1, "l")
Fx, x = F["x"]
h = x^7 + x + 1
Z = ZetaFunction(3, x^7+x+ 1)
t = gen(parent(numerator(Z)))
@test Z == (2963706958323721*t^12 - 78198072778990*t^11 - 7077028750183*t^10 + 414995654997*t^9 - 15660460025*t^8 - 620201285*t^7 + 83531230*t^6 - 1636415*t^5 - 109025*t^4 + 7623*t^3 - 343*t^2 - 10*t + 1)//(379*t^2 - 380*t + 1)

F = ResidueField(FlintZZ, 379)
Fx, x = F["x"]
h = x^7 + x + 1
Z = ZetaFunction(3, x^7+x+ 1)
t = gen(parent(numerator(Z)))
@test Z == (2963706958323721*t^12 - 78198072778990*t^11 - 7077028750183*t^10 + 414995654997*t^9 - 15660460025*t^8 - 620201285*t^7 + 83531230*t^6 - 1636415*t^5 - 109025*t^4 + 7623*t^3 - 343*t^2 - 10*t + 1)//(379*t^2 - 380*t + 1)

F = ResidueField(FlintZZ, fmpz(379))
Fx, x = F["x"]
h = x^7 + x + 1
Z = ZetaFunction(3, x^7+x+ 1)
t = gen(parent(numerator(Z)))
@test Z == (2963706958323721*t^12 - 78198072778990*t^11 - 7077028750183*t^10 + 414995654997*t^9 - 15660460025*t^8 - 620201285*t^7 + 83531230*t^6 - 1636415*t^5 - 109025*t^4 + 7623*t^3 - 343*t^2 - 10*t + 1)//(379*t^2 - 380*t + 1)
